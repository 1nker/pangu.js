/*!
 * pangu.js
 * --------
 * @version: 4.0.0
 * @homepage: https://github.com/vinta/pangu.js
 * @license: MIT
 * @author: Vinta Chen <vinta.chen@gmail.com> (https://github.com/vinta)
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("pangu",[],t):"object"==typeof exports?exports.pangu=t():e.pangu=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var o,a,r;a=[n(1)],void 0===(r="function"==typeof(o=function(t){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=a(this,r(t).call(this))).topTags=/^(html|head|body|#document)$/i,e.ignoreTags=/^(script|code|pre|textarea)$/i,e.spaceSensitiveTags=/^(a|del|pre|s|strike|u)$/i,e.spaceLikeTags=/^(br|hr|i|img|pangu)$/i,e.blockTags=/^(div|h1|h2|h3|h4|h5|h6|p)$/i,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),n=t,(i=[{key:"canIgnoreNode",value:function(e){for(var t=e.parentNode;t&&t.nodeName&&-1===t.nodeName.search(this.topTags);){if(t.nodeName.search(this.ignoreTags)>=0||t.isContentEditable||"true"===t.getAttribute("g_editable"))return!0;t=t.parentNode}return!1}},{key:"isFirstTextChild",value:function(e,t){for(var n=e.childNodes,o=0;o<n.length;o++){var a=n[o];if(8!==a.nodeType&&a.textContent)return a===t}return!1}},{key:"isLastTextChild",value:function(e,t){for(var n=e.childNodes,o=n.length-1;o>-1;o--){var a=n[o];if(8!==a.nodeType&&a.textContent)return a===t}return!1}},{key:"spacingNodeByXPath",value:function(e,t){for(var n,o,a=document.evaluate(e,t,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),r=a.snapshotLength-1;r>-1;--r)if(n=a.snapshotItem(r),this.canIgnoreNode(n))o=n;else{var c=this.spacing(n.data);if(n.data!==c&&(n.data=c),o){if(n.nextSibling&&n.nextSibling.nodeName.search(this.spaceLikeTags)>=0){o=n;continue}var i=n.data.toString().substr(-1)+o.data.toString().substr(0,1),s=this.spacing(i);if(s!==i){for(var u=o;u.parentNode&&-1===u.nodeName.search(this.spaceSensitiveTags)&&this.isFirstTextChild(u.parentNode,u);)u=u.parentNode;for(var l=n;l.parentNode&&-1===l.nodeName.search(this.spaceSensitiveTags)&&this.isLastTextChild(l.parentNode,l);)l=l.parentNode;if(l.nextSibling&&l.nextSibling.nodeName.search(this.spaceLikeTags)>=0){o=n;continue}if(-1===l.nodeName.search(this.blockTags))if(-1===u.nodeName.search(this.spaceSensitiveTags))-1===u.nodeName.search(this.ignoreTags)&&-1===u.nodeName.search(this.blockTags)&&(o.previousSibling?-1===o.previousSibling.nodeName.search(this.spaceLikeTags)&&(o.data=" ".concat(o.data)):this.canIgnoreNode(o)||(o.data=" ".concat(o.data)));else if(-1===l.nodeName.search(this.spaceSensitiveTags))n.data="".concat(n.data," ");else{var p=document.createElement("pangu");p.innerHTML=" ",u.previousSibling?-1===u.previousSibling.nodeName.search(this.spaceLikeTags)&&u.parentNode.insertBefore(p,u):u.parentNode.insertBefore(p,u),p.previousElementSibling||p.parentNode&&p.parentNode.removeChild(p)}}}o=n}}},{key:"spacingNode",value:function(e){this.spacingNodeByXPath(".//*/text()[normalize-space(.)]",e)}},{key:"spacingElementById",value:function(e){var t='id("'.concat(e,'")//text()');this.spacingNodeByXPath(t,document)}},{key:"spacingElementByClassName",value:function(e){var t='//*[contains(concat(" ", normalize-space(@class), " "), "'.concat(e,'")]//text()');this.spacingNodeByXPath(t,document)}},{key:"spacingElementByTagName",value:function(e){var t="//".concat(e,"//text()");this.spacingNodeByXPath(t,document)}},{key:"spacingPageTitle",value:function(){this.spacingNodeByXPath("/html/head/title/text()",document)}},{key:"spacingPageBody",value:function(){for(var e="/html/body//*/text()[normalize-space(.)]",t=["script","style","textarea"],n=0;n<t.length;n++){var o=t[n];e+='[translate(name(..),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")!="'.concat(o,'"]')}this.spacingNodeByXPath(e,document)}},{key:"spacingPage",value:function(){this.spacingPageTitle(),this.spacingPageBody()}}])&&o(n.prototype,i),s&&o(n,s),t;var n,i,s}(t.Pangu),s=new i;e.exports=s,e.exports.Pangu=i})?o.apply(t,a):o)||(e.exports=r)},function(e,t,n){var o,a,r;a=[],void 0===(r="function"==typeof(o=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o="⺀-⻿⼀-⿟぀-ゟ゠-ヿ㄀-ㄯ㈀-㋿㐀-䶿一-鿿豈-﫿",a=new RegExp("[".concat(o,"]")),r=new RegExp("([".concat(o,"])([\\s]?)([~\\!;\\:,\\.\\?]+)([\\s]?)([").concat(o,"])"),"g"),c=new RegExp("([".concat(o,"])([\\+\\-\\*\\/=&\\|<>])([A-Za-z0-9])"),"g"),i=new RegExp("([A-Za-z0-9])([\\+\\-\\*\\/=&\\|<>])([".concat(o,"])"),"g"),s=new RegExp("([\\/])( )([a-z0-9\\-_\\.\\/]+)","g"),u=new RegExp("([\\/\\.])([A-Za-z0-9\\-_\\.\\/]+)( )([\\/])","g"),l=new RegExp("([".concat(o,"])([A-Za-z0-9`~\\!\\$%\\^&\\*\\(\\)\\-\\=\\+\\[\\]\\{\\}\\\\;\\:'\",\\<\\.\\>\\/\\?\\u00a1-\\u00ff\\u2022\\u2027\\u2150-\\u218f]+)([").concat(o,"])"),"g"),p=(new RegExp("([".concat(o,"])\\:([A-Z0-9])"),"g"),new RegExp("([".concat(o,"])([\\s]+)([A-Za-z0-9`~\\!#\\$%\\^&\\*\\(\\)\\-\\=\\+\\[\\]\\{\\}\\\\;\\:'\",\\<\\>\\/\\?\\u00a1-\\u00ff\\u2022\\u2027\\u2150-\\u218f]+)([").concat(o,"])"),"g")),f=new RegExp("([".concat(o,"])([A-Za-z0-9`~\\!#\\$%\\^&\\*\\(\\)\\-\\=\\+\\[\\]\\{\\}\\\\;\\:'\",\\<\\>\\/\\?\\u00a1-\\u00ff\\u2022\\u2027\\u2150-\\u218f]+)([\\s]+)([").concat(o,"])"),"g"),g=new RegExp("([".concat(o,"])([@])([").concat(o,"])"),"g"),d=new RegExp("([".concat(o,"])([A-Za-z0-9@#])"),"g"),y=new RegExp("([A-Za-z0-9])([".concat(o,"])"),"g"),h=new RegExp("([A-Za-z0-9])([\\(\\[\\{])","g"),b=new RegExp("([\\)\\]\\}])([A-Za-z0-9])","g"),m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o=e,(m=[{key:"spacing",value:function(e){if("string"!=typeof e)return console.warn("Pangu.spacing(text) only accepts string but got ".concat(t(e))),e;if(!a.test(e))return e;var n=e;return console.log(0,"newText",n),n=n.replace(r,function(e,t,n,o,a,r){return o=(o=(o=(o=(o=(o=(o=o.replace(/~/g,"～")).replace(/!/g,"！")).replace(/;/g,"；")).replace(/:/g,"：")).replace(/,/g,"，")).replace(/\./g,"。")).replace(/\?/g,"？"),"".concat(t).concat(o).concat(r)}),console.log(0,"cjkSpaceSymbolsSpaceCjk",n),n=n.replace(c,"$1 $2 $3"),console.log(0,"cjkOperatorAns",n),n=n.replace(i,"$1 $2 $3"),console.log(0,"ansOperatorCjk",n),n=n.replace(s,"$1$3"),console.log(0,"fixSlashSpaceAns",n),n=n.replace(u,"$1$2$4"),console.log(0,"fixAnsSlashSpace",n),n=n.replace(l,"$1 $2 $3"),console.log(0,"cjkAnsCjk",n),n=n.replace(p,"$1$2$3 $4"),console.log(0,"cjkSpaceAnsCjk",n),n=n.replace(f,"$1 $2$3$4"),console.log(0,"cjkAnsSpaceCjk",n),n=n.replace(g,"$1 $2$3"),console.log(0,"cjkSymbolCjkAddLeftSpace",n),n=n.replace(d,"$1 $2"),console.log(0,"cjkAns",n),n=n.replace(y,"$1 $2"),console.log(0,"ansCjk",n),n=n.replace(h,"$1 $2"),console.log(0,"anLeftSymbol",n),n=n.replace(b,"$1 $2"),console.log(0,"rightSymbolAn",n),n}},{key:"spacingText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};try{var n=this.spacing(e);t(null,n)}catch(e){t(e)}}}])&&n(o.prototype,m),v&&n(o,v),e;var o,m,v}(),v=new m;e.exports=v,e.exports.default=v,e.exports.Pangu=m})?o.apply(t,a):o)||(e.exports=r)}])});