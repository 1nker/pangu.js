/*
 * pangu.js
 * --------
 * @version: 2.2.2
 * @author: Vinta <vinta.chen@gmail.com> (https://github.com/vinta)
 * @license: MIT License
 * @url: https://github.com/vinta/paranoid-auto-spacing
 * @description: Insert a white space between full-width characters (Chinese, Japanese, etc.) and half-width alphanumerics. For good readability.
 */
!function(a){function b(a){for(var b=a.parentNode;b;){if("true"==b.contentEditable)return!0;b=b.parentNode}return!1}function c(a,b){for(var c=a.childNodes,d=0;d<c.length;d++)if(child_node=c[d],8!=child_node.nodeType&&child_node.textContent)return child_node==b;return!1}function d(a,b){for(var c=a.childNodes,d=c.length-1;d>-1;d--)if(child_node=c[d],8!=child_node.nodeType&&child_node.textContent)return child_node==b;return!1}function e(a){var b,c=a;return a=a.replace(/([一-龥぀-ヿ])(["'])/gi,"$1 $2"),a=a.replace(/(["'])([一-龥぀-ヿ])/gi,"$1 $2"),a=a.replace(/(["']+)(\s*)(.*?)(\s*)(["']+)/gi,"$1$3$5"),a=a.replace(/([一-龥぀-ヿ])(#(\S+))/gi,"$1 $2"),a=a.replace(/((\S+)#)([一-龥぀-ヿ])/gi,"$1 $3"),c=a,b=c.replace(/([一-龥぀-ヿ])([<\[\{\(]+(.*?)[>\]\}\)]+)([一-龥぀-ヿ])/gi,"$1 $2 $4"),a=b,c==b&&(a=a.replace(/([一-龥぀-ヿ])([<>\[\]\{\}\(\)])/gi,"$1 $2"),a=a.replace(/([<>\[\]\{\}\(\)])([一-龥぀-ヿ])/gi,"$1 $2")),a=a.replace(/([<\[\{\(]+)(\s*)(.*?)(\s*)([>\]\}\)]+)/gi,"$1$3$5"),a=a.replace(/([一-龥぀-ヿ])([a-z0-9@&=`\|\$\%\^\*\-\+\/\\])/gi,"$1 $2"),a=a.replace(/([a-z0-9!~&;=`\|\,\.\:\?\$\%\^\*\-\+\/\\])([一-龥぀-ヿ])/gi,"$1 $2")}function f(a){for(var f,g=!1,h=document.evaluate(a,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),i=h.snapshotLength,j=i-1;j>-1;--j){var k=h.snapshotItem(j);if(b(k))f=k;else{var l=e(k.data);if(k.data!=l&&(g=!0,k.data=l),f){if(k.nextSibling&&k.nextSibling.nodeName.search(/^(br|hr)$/i)>=0){f=k;continue}var m=k.data.toString().substr(-1)+f.data.toString().substr(0,1),n=e(m);if(m!=n){g=!0;for(var o=/^(a|del|pre|s|strike|u)$/i,p=/^(div|h1|h2|h3|h4|h5|h6|p)$/i,q=f;q.parentNode&&-1==q.nodeName.search(o)&&c(q.parentNode,q);)q=q.parentNode;for(var r=k;r.parentNode&&-1==r.nodeName.search(o)&&d(r.parentNode,r);)r=r.parentNode;if(r.nextSibling&&r.nextSibling.nodeName.search(/^(br|hr)$/i)>=0){f=k;continue}-1==r.nodeName.search(p)&&(-1==q.nodeName.search(o)?-1==q.nodeName.search(p)&&(f.data=" "+f.data):-1==r.nodeName.search(o)?k.data=k.data+" ":q.parentNode.insertBefore(document.createTextNode(" "),q))}}f=k}}return g}a.text_spacing=function(a){return e(a)},a.page_spacing=function(){var a="/html/head/title/text()";f(a);var b="/html/body//*[not(@contenteditable)]/text()[normalize-space(.)]",b="/html/body//*/text()[normalize-space(.)]";["script","style","textarea"].forEach(function(a){b+='[translate(name(..),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")!="'+a+'"]'});var c=f(b);return c},a.element_spacing=function(a){var b;if(0===a.indexOf("#")){var c=a.substr(1,a.length-1);b='id("'+c+'")//text()'}else if(0===a.indexOf(".")){var d=a.slice(1);b='//*[contains(concat(" ", normalize-space(@class), " "), " '+d+' ")]/text()'}else{var e=a;b="//"+e+"//text()"}var g=f(b);return g}}(window.pangu=window.pangu||{});